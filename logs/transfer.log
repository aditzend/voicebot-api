September 7, 2021 7:28 PM cambiando a rasa 2.8 para que se puedan importar los modelos de botsociety

Los modelos iniciales ahora estan en configs pero para que entrene el bot hay que entrar y poner rasa train.

No se puede compartir un modelo por volumen porque en cuanto entrena lo pisaria si lo esta usando otro.

tampoco se puede poner un tarball como config

September 7, 2021 10:00 PM arme un stack-chatbot 2.2.0 sin kbs y con los archivos iniciales de entrenamiento como configs

[Bitbucket](https://bitbucket.org/mitrol-innovation/stack-chatbot/src/2.2.0/)

```bash
raise RasaException(
rasa.shared.exceptions.RasaException: Error when trying to expand the environment variables in '${TRACKER_STORE_TYPE}'. Please make sure to also set these environment variables: '['${TRACKER_STORE_TYPE}']'.
RasaException: Error when trying to expand the environment variables in '${TRACKER_STORE_TYPE}'. Please make sure to also set these environment variables: '['${TRACKER_STORE_TYPE}']'.
```

se soluciono cambiando el endpoint para el worker

September 8, 2021 12:27 AM 

hay problemas con las configs, voy a ir sin nada

Anda perfecto, v2.2.1

Para entrenar el modelo inicial toma 1gb de memoria y llego a 130% de CPU (no entiendo como )

Eso se ve desde adentro del contenedor, en el grafiquito, con 1s se ve perfecto

September 10, 2021 8:27 PM voy a hacer una imagen con un modelo que responda a hola y algunos starters. 

Le saco las configs para que no haya que hacerlas externamente, no fue una idea feliz

September 10, 2021 10:08 PM arme 

`alexanderditzend/rasa:bm-ini-eng-2.8.5`

tiene un modelo entrenado en ingles y todos los archivos para que se entienda que es lo que hay que reemplazar

hay que probar de instalar botfront, eso es para devs y creo que tiene algo para mantenimiento tipo rasa x. 

Se podria instalar tambien rasa x pero no es open source.

estaria bueno pensar como resolver agregado automatico de conocimientos, sin tener que armar intencion y ejemplos.

September 20, 2021 1:47 PM antes de instalar el trainer tengo que ver la nueva estructura de archivos, si no voy a tener kbs y uso rules es necesario cambiar el codigo fuente del trainer.

September 21, 2021 12:03 PM probando 2.8.5 con rules

me hice un venv en 

```jsx
Documents/rasa/2.8.5
```

clono rasa aca

estan los ejemplos, entre ellos kb

Esta muy bien este modelo

```jsx
Your input ->  hi
Hello! How can I help you?
Your input ->  list some restaurants
Found the following objects of type 'restaurant':
1: Pfefferberg
2: I due forni
3: Donath
4: Lụa Restaurant
5: Marubi Ramen
Your input ->  do you know what cuisine the last one has?
'Marubi Ramen' has the value 'Japanese' for attribute 'cuisine'.
Your input ->  do you know the price range of that one?
'Marubi Ramen' has the value 'cheap' for attribute 'price-range'.
```

Hago una version mas simple para respuestas con json

el problema que tengo es que el atributo se tiene que escribir igual que en el json

por ejemplo, no se puede poner lago-mar porque no lo va a encontrar

para los atributos si hay ejemplos de esto, sera cuestion de probar

September 21, 2021 6:07 PM arme un modelo pero el action server pide una key city que me olvide de cambiar

September 23, 2021 11:29 AM call con pedro y funcionales

September 23, 2021 12:12 PM quedamos en que cris iba a ver a partir de que nivel de complejidad el bot no puede mas y yo iba a tomar el bot de el para desarrollarlo.

September 24, 2021 1:10 PM investigando porque falla la exportacion de botsociety. Viendo si botfront puede ser una alternativa mejor.

instalo botfront en mib

meto dos intents y me dice

Error: An unexpected error occurred during training. Error: string indices must be integers

Segun esto el problema es gazette

[training not starting in botfront](https://stackoverflow.com/questions/68194797/training-not-starting-in-botfront)

anduvo, modelo entrenado

```markdown
rasa_addons.core.channels.webchat.WebchatInput:
  session_persistence: true
  base_url: 'http://192.168.43.169:5005'
  socket_path: /socket.io/
rasa_addons.core.channels.bot_regression_test.BotRegressionTestInput: {}

```

September 24, 2021 3:44 PM no me puedo volver a loguear

instalo de nuevo

September 24, 2021 7:19 PM probando los exports de botsociety

![Screen Shot 2021-09-24 at 19.19.32.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/44e11c9c-008a-4945-b838-f20112abfddc/Screen_Shot_2021-09-24_at_19.19.32.png)

cuando le doy play en botsociety

![Screen Shot 2021-09-24 at 19.20.11.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0f5c3d91-ef61-470a-9586-2c0374d7dbf9/Screen_Shot_2021-09-24_at_19.20.11.png)

el modelo entrenado, probando con rasa shell

Ahi lo logre, anda perfecto despues de unos retoques a mano, no tocar la version porque ahi si que se pudre todo, esto es sobre rasa 2.8.5

![Screen Shot 2021-09-24 at 19.33.53.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/96dee795-4900-411d-87e9-6abc44ad36bc/Screen_Shot_2021-09-24_at_19.33.53.png)

Otra vez sopa, version 5bank entrenada directo desde bs

![Screen Shot 2021-09-24 at 19.38.42.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b437f660-84a8-4a37-9416-1dc8c13309b3/Screen_Shot_2021-09-24_at_19.38.42.png)

Creo que es el espacio de abajo

![Screen Shot 2021-09-24 at 19.43.48.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d25e9a4b-6553-47cb-972c-8af6e8b07b21/Screen_Shot_2021-09-24_at_19.43.48.png)

![Screen Shot 2021-09-24 at 19.44.10.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6e54de9e-ab8b-4073-a087-8315d667ccb3/Screen_Shot_2021-09-24_at_19.44.10.png)

era eso, hay que tener cuidado

botfront no esta manteniendose

[GitHub - botfront/botfront: Enterprise-grade open source GUI platform for Rasa teams](https://github.com/botfront/botfront)

Esto esta mas vivo pero esta medio enklenke

[GitHub - digiteinfotech/kairon: Tool suite built on RASA to train and deploy your chatbots using advanced NLP](https://github.com/digiteinfotech/kairon)

aca hay un buen widget

[GitHub - botfront/rasa-webchat: A feature-rich chat widget for Rasa and Botfront](https://github.com/botfront/rasa-webchat)

otro gui

[GitHub - navigateconsulting/virtual-assistant: Virtual Assistant](https://github.com/navigateconsulting/virtual-assistant)

usa rasa 1

parece que este es el mas movido

.w

[GitHub - paschmann/rasa-ui: Rasa UI is a frontend for the Rasa Framework](https://github.com/paschmann/rasa-ui)

una porongaa

![Screen Shot 2021-09-24 at 21.34.55.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e04e3cf1-cac6-4375-ac4f-031dbebb13b9/Screen_Shot_2021-09-24_at_21.34.55.png)

hay que hacer un fork de botfront

[RASA takeover of botfront](https://forum.rasa.com/t/rasa-takeover-of-botfront/43266/6)

otros ya lo hicieron

[](https://toscode.gitee.com/Bobokingbao/botfront)

por ejemplo

dejo instalado botfront en mib:8888 

September 28, 2021 6:38 PM instalando k8s que es lo que recomienda RASA para entornos de produccion.

Hoy se le mostro a Cris como hacer modelos desde botsociety para que entrenen directo sin problemas.

[](https://computingforgeeks.com/deploy-kubernetes-cluster-on-ubuntu-with-kubeadm/)

```markdown
Container runtime (Docker,cri-o,containerd, e.t.c) and Kubernetes tools(kubeadm and kubelet) installed in your Worker node.
```

centos 7

```markdown
[beta@master-node ~]$ sudo firewall-cmd --permanent --add-port=6443/tcp
[sudo] password for beta:
sudo: firewall-cmd: command not found
```

```markdown
kubeadm join 200.58.96.229:6443 --token tbb85g.4u6tkre0papd12b8 \
	--discovery-token-ca-cert-hash sha256:44abbf9bdf369d7917edf5aec770f3e52c6ba0c67282bd5d2ea3ca68ea69b1a5
```

root beta

```markdown
kubeadm join 200.58.96.229:6443 --token sdkwcr.yuc3stb1s915z1vp --discovery-token-ca-cert-hash sha256:79a6bfa7437d4e6dd3ba3f62c85ee36b1e205ae5a6e53681c68ed19d779dd333
```

[How to Install a Kubernetes Cluster on CentOS 7](https://www.tecmint.com/install-kubernetes-cluster-on-centos-7/)

[](https://computingforgeeks.com/configure-kubernetes-dynamic-volume-provisioning-with-heketi-glusterfs/)

September 28, 2021 11:26 PM portainer necesita una storageClass

[Install Portainer with Kubernetes on your Self-Managed Infrastructure](https://docs.portainer.io/v/ce-2.9/start/install/server/kubernetes/baremetal)

September 29, 2021 10:37 AM experimentando con botfront, el modelo 6bank no se importa bien, trae algunas cosas pero no todas

pruebo haciendo un modelo ultra simple dentro de botfront para ver que es lo que rompe

September 29, 2021 11:46 AM encontre cosas increibles, el modelo anda bien dentro de la imagen tuneada de ellos, en una 2.8.5 standard patea.

las respuestas se pueden cambiar sin reentrenar, obviamente no se puede cambiar el nombre de las respuestas. es como si huvbiera una base de datos de respuestas.

la api no esta habilitada habria que ver el codigo de botfront up para editar el comando

September 29, 2021 11:56 AM 

exportar directo a rasa 2.8.5 no funciona, hay problemas con el domain

```bash
 rasa train
YamlValidationException: Failed to validate '/Users/alex/Documents/rasa/t1/domain.yml'. Please make sure the file is correct and all mandatory parameters are specified. Here are the errors found during validation:
  in /Users/alex/Documents/rasa/t1/domain.yml:18:
      Key 'language' was not defined. Path: '/responses/utter_Hqj5EBJd2/0'
  in /Users/alex/Documents/rasa/t1/domain.yml:21:
      Key 'language' was not defined. Path: '/responses/utter_esta_todo_reservado/0'
  in /Users/alex/Documents/rasa/t1/domain.yml:24:
      Key 'language' was not defined. Path: '/responses/utter_esta_todo_reservado/1'
  in /Users/alex/Documents/rasa/t1/domain.yml:28:
      Key 'language' was not defined. Path: '/responses/utter_pER-boxc_/0'
```

October 12, 2021 1:06 PM preparando un local persistent volume para mib

instalando un nfs server en beta y un cliente en alfa

[](https://www.jorgedelacruz.es/2017/12/26/kubernetes-volumenes-nfs/)

instalando kubernetes en mia y mib 

[](https://computingforgeeks.com/deploy-kubernetes-cluster-on-ubuntu-with-kubeadm/)

cambio el host en alfa

```markup
192.168.43.167 k8s-innovation.mitrol.net
```

error

```markup
Unfortunately, an error has occurred:
		timed out waiting for the condition

	This error is likely caused by:
		- The kubelet is not running
		- The kubelet is unhealthy due to a misconfiguration of the node in some way (required cgroups disabled)

	If you are on a systemd-powered system, you can try to troubleshoot the error with the following commands:
		- 'systemctl status kubelet'
		- 'journalctl -xeu kubelet'

	Additionally, a control plane component may have crashed or exited when started by the container runtime.
	To troubleshoot, list all containers using your preferred container runtimes CLI.

	Here is one example how you may list all Kubernetes containers running in docker:
		- 'docker ps -a | grep kube | grep -v pause'
		Once you have found the failing container, you can inspect its logs with:
		- 'docker logs CONTAINERID'

error execution phase wait-control-plane: couldn't initialize a Kubernetes cluster
To see the stack trace of this error execute with --v=5 or higher
```

pruebo en scb

```markup
k8s-cluster.saia.ar		200.58.96.229	
  
k8s-master01.saia.ar		200.58.96.229	
  
k8s-master02.saia.ar		179.43.126.49

k8s-worker02.saia.ar   66.97.35.203
```

create cluster

```markup
sudo kubeadm init \
  --pod-network-cidr=192.168.0.0/16 \
  --upload-certs \
  --control-plane-endpoint=k8s-cluster.saia.ar
```

```markup
sudo kubeadm init \
  --pod-network-cidr=192.168.0.0/16 \
  --docker-socket /var/run/docker.sock \
  --upload-certs \
  --control-plane-endpoint=k8s-cluster.computingforgeeks.com
```

voy al libro, para hacer permissive el selinux primero tengo que instalarlo creo

[](https://linuxconfig.org/how-to-disable-enable-selinux-on-ubuntu-20-04-focal-fossa-linux)

trato de instalar el control plane en scc con centos 7

abri todos los puertos que dice este tut

[How to Install Kubernetes (k8s) 1.7 on CentOS 7 / RHEL 7](https://www.linuxtechi.com/install-kubernetes-1-7-centos7-rhel7/)

```bash
setenforce 0
```

```bash
cat <<EOF > /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg
         https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
EOF
```

guarda con los espacios del repo de yum, hay que respetarlos

```bash
yum install -y docker kubelet kubeadm kubectl kubernetes-cni
```

```bash
systemctl enable docker && systemctl start docker
```

```bash
systemctl enable kubelet && systemctl start kubelet
```

```bash
sysctl -w net.bridge.bridge-nf-call-iptables=1
```

```bash
echo "net.bridge.bridge-nf-call-iptables=1" > /etc/sysctl.d/k8s.conf
```

```bash
swapoff -a &&  sed -i '/ swap / s/^/#/' /etc/fstab
```

```bash
kubeadm join 179.43.126.49:6443 --token gr43ho.5gru6clkh8nmzmj9 \
        --discovery-token-ca-cert-hash sha256:d25766f3bbcc5791a585cb4f707a96376166a5f9a4f2c542ca94f93c10a11cc9
[gamma@k8s-master02 ~]$
```

```bash
kubeadm join 179.43.126.49:6443 --token gr43ho.5gru6clkh8nmzmj9 \
        --discovery-token-ca-cert-hash sha256:d25766f3bbcc5791a585cb4f707a96376166a5f9a4f2c542ca94f93c10a11cc9
```

```bash
kubectl apply -f "https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\n')
```

```bash
scp root@179.43.126.49:/etc/kubernetes/admin.conf ~/.kube/config2
```

```bash
scp -P 5132 gamma@179.43.126.49:/home/gamma/admin.conf ~/.kube/saia
```

```bash
kubeadm join 179.43.126.49:6443 --token pew55b.28vaxykqmmazj0mm --discovery-token-ca-cert-hash sha256:3d686919ee972932976c7e95003d92f74d2fffd11e55aececb8cc59d1a097717
```

October 18, 2021 4:10 PM 

creando servicio de ingress

October 20, 2021 11:26 AM 

error de entrenamiento

```bash
Error: An unexpected error occurred during training. Error: Contradicting rules or stories found 🚨 - the prediction of the action 'utter_3Ey6IiOwn' in rule 'get_started' is contradicting with rule(s) 'Get started'. - the prediction of the action 'utter_get_started' in rule 'Get started' is contradicting with rule(s) 'get_started'. Please update your stories and rules so that they don't contradict each other. You can find more information about the usage of rules at https://rasa.com/docs/rasa/rules.
```

October 20, 2021 6:02 PM 

pasos para arrancar botfront en MIA

[Deploy Botfront and Rasa on Kubernetes | Docs](https://botfront.io/docs/installation/server-cluster)

- crear dir
- botfront init
- `vi .botfront/botfront.yml`
- poner la ip en `root_url`
- `botfront up`
- panel corriendo en `mia:8888`
- crear un proyecto
- copiar el id de proyecto
- `botfront set-project [id copiado]`
- dentro del proyecto entrar a `settings/credentials` y poner la ip de mia en `base_url`
- en el domain.yml comentar la linea de gazzette para que entrene bien
- dentro del dir del proyecto `sudo chown -R mituser models && sudo chmod -R 774 models`

October 22, 2021 11:10 AM necesita un nfs

esta en 

```bash
/nfsfileshare
```

ip privada

```bash
192.168.200.10
```

[How To Setup NFS Server on CentOS 7 / RHEL 7 - Centos/Redhat](https://www.itzgeek.com/how-tos/linux/centos-how-tos/how-to-setup-nfs-server-on-centos-7-rhel-7-fedora-22.html](https://www.itzgeek.com/how-tos/linux/centos-how-tos/how-to-setup-nfs-server-on-centos-7-rhel-7-fedora-22.html))

autorizo solo a km2 con su ip 200.11

storage distribuido

[Kubernetes Storage Concepts | OpenEBS Docs](https://openebs.io/docs/concepts/basics)

```bash
helm install openebs-nfs-wp stable/nfs-server-provisioner --namespace=ns-nfs-wp --set=persistence.enabled=true,persistence.storageClass=openebs-cstor-disk,persistence.size=5Gi,storageClass.name=wordpress-nfs-sc1,storageClass.provisionerName=openebs.io/nfs
```

October 23, 2021 8:31 PM hay snapshots de las 3 vms

```bash
kubeadm join 179.43.126.49:6443 --token g6o7gm.q8uhhi0v7ul47hjy \
        --discovery-token-ca-cert-hash sha256:e584593f1084b3a206585350a79e8fb71dd3e543b59c09fb237852c88faab17d
```

```bash
kubectl apply -f "https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\n')"
```

October 25, 2021 10:44 AM tengo openebs corriendo, el comando de helm generaba errores contra etcd

October 27, 2021 11:11 PM sigo con el problema del dbsync en multibot

agrego el campo BotId

```bash
IF DB_ID('BotReports') IS NULL CREATE DATABASE BotReports;
GO
USE BotReports; 
   
IF OBJECT_ID ('dbo.Conversations', 'U') IS NOT NULL 
   DROP TABLE Conversations; 
GO 

 
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DeepChats](
[Id] [int] IDENTITY(1,1) NOT NULL,
[BotId] [char](25) NOT NULL,
[CreatedAt] [datetimeoffset](7) NOT NULL,
[InteractionID] [char](25) NOT NULL,
[ActorShort] [char](3) NOT NULL,
[TypeShort] [char](3) NOT NULL,
[Body] [varchar](max) NOT NULL,
[TypeLong] [varchar](max) NULL,
[ActorLong] [varchar](max) NULL,
[Confidence] [decimal](4, 2) NULL,
[BotDb] [varchar](255) NULL,
[BotName] [varchar](255) NULL,
[BotBody] [varchar](max) NULL,
[MiliTimestamp] [varchar](255) NULL,
[Offset] [int] NULL,
[Segment] [int] NOT NULL,
[Intent] [varchar](255) NULL,
[SuggestedIntent] [varchar](255) NULL,
[CategoryLevel1] [varchar](255) NULL,
[CategoryLevel2] [varchar](255) NULL,
[CategoryLevel3] [varchar](255) NULL,
[CategoryLevel4] [varchar](255) NULL,
PRIMARY KEY CLUSTERED
(
[Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
```

October 28, 2021 10:28 AM nuevo botfarm con mongo-express, se ve en mib:30081 

[Mongo-express - Official Image | Docker Hub](https://hub.docker.com/_/mongo-express)

```bash
# Stack botfarm para Chatbot 2.1
# Listo para Traefik
# REST API en el Gateway
# agrego mongo express 28/10/2021
# abro puertos de redis y mongo para probar de mi maquina

version: '3.8'

services:

  gateway:
    image: aditzend/gateway:apirest
    labels:
      botfarm: gateway
      #com.docker.stack.service.name: "gateway"
      #traefik.enable: "true"
    ports:
        #Puerto del WebSocket
      - target: 8646
        published: 3${STACK_CODE-00}46 # concordia tiene que estar conectado a este puerto
        protocol: tcp
        mode: host
        #Puerto de la REST API
      - target: 8656
        published: 3${STACK_CODE-00}56 # REST API tiene que pegarle a este puerto
        protocol: tcp
        mode: host
    environment:
      - WEB_SOCKET_PORT=8646
      - WAIT_TIME_BETWEEN_MESSAGES=${GATEWAY_WAIT_TIME_BETWEEN_MESSAGES-0.00000000001} # segundos
      - POLLING_INTERVAL=${GATEWAY_POLLING_INTERVAL-500} # milisegundos
      - MODE=${GATEWAY_MODE-DEBUG}
    networks:
      - public
      - proxy

  redis:
    image: redis:6.0.1-alpine3.11
    labels:
      botfarm: redis
    command: ["redis-server","--appendonly","yes"]
    ports:
      - 30079:6379
    volumes:
      - redis_data:/data
    networks:
      - public

  mongo:
    image: mongo:4.4.4
    labels:
      botfarm: mongo
    deploy:
      replicas: 1
    volumes:
      - mongo_data:/data/db
    ports:
      - 30017:27017
    #environment:
      #MONGO_INITDB_ROOT_USERNAME: ${MONGO_INITDB_ROOT_USERNAME-root}
      #MONGO_INITDB_ROOT_PASSWORD: ${MONGO_INITDB_ROOT_PASSWORD-Mitrol40}
    networks:
      - public
    #entrypoint: ["mongod"]
    # para correr cuando esten creados los usuarios non root, usar la linea de abajo
    #entrypoint: ["mongod", "--auth"]
  
  mongo-express:
    image: mongo-express
    networks:
      - public
    ports:
      - target: 8081
        published: 3${STACK_CODE-00}81 
        protocol: tcp
        mode: host
    environment:
      ME_CONFIG_OPTIONS_EDITORTHEME: "ambiance" 
      ME_CONFIG_MONGODB_SERVER: "mongo"
      ME_CONFIG_BASICAUTH_USERNAME: "root"
      ME_CONFIG_BASICAUTH_PASSWORD: "Mitrol40"
      #ME_CONFIG_MONGODB_ADMINUSERNAME: "root"
      #ME_CONFIG_MONGODB_ADMINPASSWORD: "Mitrol40"
      ME_CONFIG_MONGODB_ENABLE_ADMIN: "true"
      

  duckling:
    image: rasa/duckling:0.1.6.2
    labels:
      botfarm: duckling
    #ports:
     # - 3${STACK_CODE-00}62:8000
    networks:
      - public
    
networks:
  private:
  public:
  proxy:
    external: true
    name: ${PROXY_NET-traefik_net}

volumes:
  mongo_data:
  redis_data:
  web_server_data:
```

```json
{
  "interactionId": "211028105937399_CHT_56000",
  "segmentId": 1,
  "date": "2021-10-28T13:59:37.408Z",
  "chatId": "01f8yvsqalcny111q1nzxjvouh2j",
  "from": {
    "userName": "CLI01jwm7ss8zaeiw11s6kungfyz1me",
    "displayName": "t2",
    "type": 0,
    "role": 0
  },
  "to": {
    "userName": "IVR11cjtu7evz0agn110ag9m5c0pj5q",
    "displayName": "Alojamiento",
    "type": 2,
    "role": 0
  },
  "events": [
    {
      "starter": {
        "userName": "CLI01jwm7ss8zaeiw11s6kungfyz1me",
        "displayName": "t2",
        "type": 0,
        "role": 0
      },
      "chatUser": {
        "userName": "IVR11cjtu7evz0agn110ag9m5c0pj5q",
        "displayName": "Alojamiento",
        "type": 2,
        "role": 0
      },
      "eventType": "NEW_CHAT",
      "date": "2021-10-28T13:59:37.399Z"
    },
    {
      "message": "Un momento por favor",
      "from": {
        "userName": "IVR11cjtu7evz0agn110ag9m5c0pj5q",
        "displayName": "Alojamiento",
        "type": 2,
        "role": 0
      },
      "eventType": "MESSAGE",
      "date": "2021-10-28T13:59:37.438Z"
    },
    {
      "message": "Hey! How are you?",
      "from": {
        "userName": "IVR11cjtu7evz0agn110ag9m5c0pj5q",
        "displayName": "Alojamiento",
        "type": 2,
        "role": 0
      },
      "eventType": "MESSAGE",
      "date": "2021-10-28T13:59:37.485Z"
    },
    {
      "message": "sad t2",
      "from": {
        "userName": "CLI01jwm7ss8zaeiw11s6kungfyz1me",
        "displayName": "t2",
        "type": 0,
        "role": 0
      },
      "eventType": "MESSAGE",
      "date": "2021-10-28T13:59:45.367Z"
    },
    {
      "message": "Here is something to cheer you up:",
      "from": {
        "userName": "IVR11cjtu7evz0agn110ag9m5c0pj5q",
        "displayName": "Alojamiento",
        "type": 2,
        "role": 0
      },
      "eventType": "MESSAGE",
      "date": "2021-10-28T13:59:46.576Z"
    },
    {
      "message": "no",
      "from": {
        "userName": "CLI01jwm7ss8zaeiw11s6kungfyz1me",
        "displayName": "t2",
        "type": 0,
        "role": 0
      },
      "eventType": "MESSAGE",
      "date": "2021-10-28T13:59:52.572Z"
    },
    {
      "message": "Bye",
      "from": {
        "userName": "IVR11cjtu7evz0agn110ag9m5c0pj5q",
        "displayName": "Alojamiento",
        "type": 2,
        "role": 0
      },
      "eventType": "MESSAGE",
      "date": "2021-10-28T13:59:53.076Z"
    },
    {
      "chatUser": {
        "userName": "CLI01jwm7ss8zaeiw11s6kungfyz1me",
        "displayName": "t2",
        "type": 0,
        "role": 0
      },
      "eventType": "REMOVE_PARTICIPANT",
      "date": "2021-10-28T14:00:15.435Z"
    },
    { "eventType": "END_CHAT", "date": "2021-10-28T14:00:15.438Z" }
  ]
}
```

October 28, 2021 11:11 AM se repiten los mensajes de t2 en el panel

![Screen Shot 2021-10-28 at 11.11.25.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a610e390-5102-40d2-875d-efcdda3e437d/Screen_Shot_2021-10-28_at_11.11.25.png)

![Screen Shot 2021-10-28 at 11.11.40.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f70d6d16-bae3-4ba2-a9c6-089719e70867/Screen_Shot_2021-10-28_at_11.11.40.png)

lo tuve que parar porque seguia

claramente no es culpa del acd, ver t2-acd.json

October 28, 2021 1:06 PM los logs de dbsync 4.0.6 son ilegibles uso winston

October 29, 2021 11:27 AM estructura de logs modificada para 4.0.6 falta revisar config de logging para produccion

los otros bots estan yendo al mismo dbsync

October 29, 2021 12:50 PM borro los dbsync de los demas

se esta insertando mas veces lo que llega al bot

hola, dos veces

esto es como un mensaje de usuario, se reemplazaria con la palablra de activacion tipo /start    

```json
1) "{\"interaction_id\":\"211029130459859_CHT_56000\",\"created_at\":\"2021-10-29T13:05:02.003-03:00\",\"segment\":1,\"category_level_1\":\"Default\",\"category_level_2\":\"-\",\"category_level_3\":\"-\",\"category_level_4\":\"-\",\"intent\":\"-\",\"suggested_intent\":\"greet\",\"message\":\" hola\",\"confidence\":59.7,\"bot_db\":\"alojamiento_bm\",\"mili_timestamp\":1635523502.0030134}"
```

```json
7) "{\"interaction_id\":\"211029130459859_CHT_56000\",\"created_at\":\"2021-10-29T13:04:59.926-03:00\",\"segment\":1,\"category_level_1\":\"Default\",\"category_level_2\":\"-\",\"category_level_3\":\"-\",\"category_level_4\":\"-\",\"intent\":\"-\",\"suggested_intent\":\"greet\",\"message\":\" hola\",\"confidence\":59.7,\"bot_db\":\"alojamiento_bm\",\"mili_timestamp\":1635523499.9260974}"
```

en mongo tambien esta dos vecs

primer hola `1635523499.9260974`

```json
⊖{
        "event": "user",
        "timestamp": 1635523499.9260974,
        "text": "hola",
        "parse_data": ⊕{...},
        "input_channel": "rest",
        "message_id": "04cc38f5a78c4729b5002e770035507a",
        "metadata": {}
    },
```

el bot contesta bien y le vuelve  a llegar un mensaje de hola `1635523502.0030134`

```json
⊖{
        "event": "user",
        "timestamp": 1635523502.0030134,
        "text": "hola",
        "parse_data": ⊕{...},
        "input_channel": "rest",
        "message_id": "f62479f5ef1149e9a52b1bda8ab26739",
        "metadata": {}
    },
```

Un momento por favor ,  solo una vez

```json
"{\"interaction_id\":\"211029130459859_CHT_56000\",\"bot_id\":\"alojamiento\",\"created_at\":\"2021-10-29T13:04:59.895-03:00\",\"actor_short\":\"BOT\",\"type_short\":\"MSG\",\"body\":\"Un momento por favor\",\"type_long\":\"Mensaje\",\"actor_long\":\"Alojamiento\",\"confidence\":0.5,\"bot_db\":\"-\",\"bot_name\":\"alojamiento\",\"bot_body\":\"-\",\"mili_timestamp\":\"-\",\"offset\":6,\"segment\":1,\"intent\":\"-\",\"suggested_intent\":\"-\",\"category_level_1\":\"-\",\"category_level_2\":\"-\",\"category_level_3\":\"-\",\"category_level_4\":\"-\"}"
```

END_CHAT, solo una vez

```json
"{\"interaction_id\":\"211029130459859_CHT_56000\",\"bot_id\":\"alojamiento\",\"created_at\":\"2021-10-29T13:05:01.979-03:00\",\"actor_short\":\"SYS\",\"type_short\":\"EVT\",\"body\":\"END_CHAT\",\"type_long\":\"Evento\",\"actor_long\":\"Sistema\",\"confidence\":-2,\"bot_db\":\"-\",\"bot_body\":\"-\",\"mili_timestamp\":\"-\",\"offset\":6,\"segment\":1,\"intent\":\"-\",\"suggested_intent\":\"-\",\"category_level_1\":\"-\",\"category_level_2\":\"-\",\"category_level_3\":\"-\",\"category_level_4\":\"-\"}"
```

Hey! How are you? 3 veces

```json
4) "{\"interaction_id\":\"211029130459859_CHT_56000\",\"created_at\":\"2021-10-29T13:04:59.940-03:00\",\"segment\":1,\"category_level_1\":\"-\",\"category_level_2\":\"-\",\"category_level_3\":\"-\",\"category_level_4\":\"-\",\"intent\":\"-\",\"suggested_intent\":\"-\",\"message\":\" Hey! How are you?\",\"confidence\":-1,\"bot_db\":\"alojamiento_bm\",\"mili_timestamp\":1635523499.9406686}"
```

```json
8) "{\"interaction_id\":\"211029130459859_CHT_56000\",\"bot_id\":\"alojamiento\",\"created_at\":\"2021-10-29T13:04:59.954-03:00\",\"actor_short\":\"BOT\",\"type_short\":\"MSG\",\"body\":\"Hey! How are you?\",\"type_long\":\"Mensaje\",\"actor_long\":\"Alojamiento\",\"confidence\":0.5,\"bot_db\":\"-\",\"bot_name\":\"alojamiento\",\"bot_body\":\"-\",\"mili_timestamp\":\"-\",\"offset\":6,\"segment\":1,\"intent\":\"-\",\"suggested_intent\":\"-\",\"category_level_1\":\"-\",\"category_level_2\":\"-\",\"category_level_3\":\"-\",\"category_level_4\":\"-\"}"
```

```json
9) "{\"interaction_id\":\"211029130459859_CHT_56000\",\"created_at\":\"2021-10-29T13:05:02.033-03:00\",\"segment\":1,\"category_level_1\":\"-\",\"category_level_2\":\"-\",\"category_level_3\":\"-\",\"category_level_4\":\"-\",\"intent\":\"-\",\"suggested_intent\":\"-\",\"message\":\" Hey! How are you?\",\"confidence\":-1,\"bot_db\":\"alojamiento_bm\",\"mili_timestamp\":1635523502.0338683}"
```

October 29, 2021 1:33 PM pruebo por API y el bot hace todo bien

October 29, 2021 1:37 PM logs del gateway

```json
2021-10-29T16:40:00.729876152Z {"origin":"USER","connection_id":"211029134000685_CHT_56000","user_name":"testbotclient2","bot_name":"Alojamiento","event_name":"*online","level":"INFO"}
2021-10-29T16:40:00.730149307Z *online received
2021-10-29T16:40:00.730378022Z 
2021-10-29T16:40:00.730390505Z ------------------------------------------
2021-10-29T16:40:00.730395061Z 🔀 Requested BotName: Alojamiento    Dispatched to:  http://alojamiento_bm:5005
2021-10-29T16:40:00.730399848Z   Message sent to Bot Server : {
2021-10-29T16:40:00.730403541Z 	"method": "POST",
2021-10-29T16:40:00.730407562Z 	"uri": "http://alojamiento_bm:5005/webhooks/rest/webhook",
2021-10-29T16:40:00.730426516Z 	"body": {
2021-10-29T16:40:00.730430240Z 		"sender": "211029134000685_CHT_56000",
2021-10-29T16:40:00.730434378Z 		"message": "hola"
2021-10-29T16:40:00.730438230Z 	},
2021-10-29T16:40:00.730441870Z 	"json": true
2021-10-29T16:40:00.730445580Z }
2021-10-29T16:40:00.775371276Z 
2021-10-29T16:40:00.775411356Z ------------------------------------------
2021-10-29T16:40:00.775417977Z ➡️ Inbound : Bot Says
2021-10-29T16:40:00.775422518Z 
2021-10-29T16:40:00.775426128Z  
2021-10-29T16:40:00.775429695Z 🤖 💬   Hey! How are you?
2021-10-29T16:40:00.775433900Z ------------------------------------------
2021-10-29T16:40:00.775640884Z 
2021-10-29T16:40:00.775654495Z ⬅️   Outbound
2021-10-29T16:40:00.775659006Z 	Message sent via WebSocket: {
2021-10-29T16:40:00.775663170Z 	"InteractionId": "211029134000685_CHT_56000",
2021-10-29T16:40:00.775667603Z 	"UserName": "testbotclient2",
2021-10-29T16:40:00.775671777Z 	"Parameters": [
2021-10-29T16:40:00.775691392Z 		"user.name=testbotclient2",
2021-10-29T16:40:00.775695556Z 		"user.mail=testbotclient2@myserver.com",
2021-10-29T16:40:00.775699176Z 		"user.channel=11"
2021-10-29T16:40:00.775702663Z 	],
2021-10-29T16:40:00.775706058Z 	"Message": "Hey! How are you?",
2021-10-29T16:40:00.775709778Z 	"Channel": "web_sock",
2021-10-29T16:40:00.775713367Z 	"Lang": "es",
2021-10-29T16:40:00.775717527Z 	"Encoding": "utf-8",
2021-10-29T16:40:00.775721190Z 	"EventName": "*online",
2021-10-29T16:40:00.775724825Z 	"MimeType": "text/plain",
2021-10-29T16:40:00.775728352Z 	"Source": "186.22.18.95",
2021-10-29T16:40:00.775731865Z 	"UserChannel": "11",
2021-10-29T16:40:00.775735423Z 	"UserId": "testbotclient2",
2021-10-29T16:40:00.775738952Z 	"UserMail": "testbotclient2@myserver.com",
2021-10-29T16:40:00.775742512Z 	"BotName": "Alojamiento"
2021-10-29T16:40:00.775746072Z }
2021-10-29T16:40:00.775749503Z ========================================
2021-10-29T16:40:04.126469763Z {"origin":"USER","connection_id":"211029134000685_CHT_56000","user_name":"testbotclient2","bot_name":"Alojamiento","event_name":"*online","level":"INFO"}
2021-10-29T16:40:04.126508696Z *online received
2021-10-29T16:40:04.126514270Z 
2021-10-29T16:40:04.126519009Z ------------------------------------------
2021-10-29T16:40:04.126523347Z 🔀 Requested BotName: Alojamiento    Dispatched to:  http://alojamiento_bm:5005
2021-10-29T16:40:04.126528301Z   Message sent to Bot Server : {
2021-10-29T16:40:04.126532749Z 	"method": "POST",
2021-10-29T16:40:04.126537031Z 	"uri": "http://alojamiento_bm:5005/webhooks/rest/webhook",
2021-10-29T16:40:04.126541340Z 	"body": {
2021-10-29T16:40:04.126545300Z 		"sender": "211029134000685_CHT_56000",
2021-10-29T16:40:04.126549649Z 		"message": "hola"
2021-10-29T16:40:04.126553853Z 	},
2021-10-29T16:40:04.126557813Z 	"json": true
2021-10-29T16:40:04.126561825Z }
2021-10-29T16:40:04.190849179Z 
2021-10-29T16:40:04.190865616Z ------------------------------------------
2021-10-29T16:40:04.190870039Z ➡️ Inbound : Bot Says
2021-10-29T16:40:04.190905109Z 
2021-10-29T16:40:04.190909201Z  
2021-10-29T16:40:04.190912827Z 🤖 💬   Hey! How are you?
2021-10-29T16:40:04.190916735Z ------------------------------------------
2021-10-29T16:40:04.191137547Z 
2021-10-29T16:40:04.191147979Z ⬅️   Outbound
2021-10-29T16:40:04.191151363Z 	Message sent via WebSocket: {
2021-10-29T16:40:04.191154750Z 	"InteractionId": "211029134000685_CHT_56000",
2021-10-29T16:40:04.191158868Z 	"UserName": "testbotclient2",
2021-10-29T16:40:04.191162323Z 	"Parameters": [
2021-10-29T16:40:04.191187458Z 		"user.name=testbotclient2",
2021-10-29T16:40:04.191192168Z 		"user.mail=testbotclient2@myserver.com",
2021-10-29T16:40:04.191195589Z 		"user.channel=11"
2021-10-29T16:40:04.191198949Z 	],
2021-10-29T16:40:04.191202141Z 	"Message": "Hey! How are you?",
2021-10-29T16:40:04.191205484Z 	"Channel": "web_sock",
2021-10-29T16:40:04.191208744Z 	"Lang": "es",
2021-10-29T16:40:04.191212098Z 	"Encoding": "utf-8",
2021-10-29T16:40:04.191215391Z 	"EventName": "*online",
2021-10-29T16:40:04.191218642Z 	"MimeType": "text/plain",
2021-10-29T16:40:04.191221858Z 	"Source": "",
2021-10-29T16:40:04.191225132Z 	"UserChannel": "11",
2021-10-29T16:40:04.191228341Z 	"UserId": "testbotclient2",
2021-10-29T16:40:04.191231628Z 	"UserMail": "testbotclient2@myserver.com",
2021-10-29T16:40:04.191234948Z 	"BotName": "Alojamiento"
2021-10-29T16:40:04.191238278Z }
2021-10-29T16:40:04.191241349Z ========================================
```

Despues de la respuesta me vuelve a tirar el *online

`2021-10-29T16:40:00.730149307Z *online received`

`2021-10-29T16:40:04.126508696Z *online received`

November 1, 2021 1:30 PM rancher 2.6.2 

versiones de docker compatibles

[Untitled](https://www.notion.so/59dbd916d32f4a818a113077e1a7770f)

### **RKE CLI & K8S for Local Cluster**

[Untitled](https://www.notion.so/75ef6c3677224be99d8e38f695428002)

borro  a cero km0

instalo docker en centos con root siguiendo 

[Install Docker Engine on CentOS](https://docs.docker.com/engine/install/centos/)

el bot esta devolviendo un eventname tipo *online con la primera respuesta

November 1, 2021 11:08 PM mejoras del gateway ante mensajes erroneos

migracion a codigo funcional

eliminacion de variables globales

November 2, 2021 1:33 PM corrijo los envios del socket porque estan los de la api

November 2, 2021 6:06 PM se pueden setear eventos en el online, decido poner todo los que venga en params, si el modelo no tiene esos slots no pasa nada, pero si los tiene se tienen que llamar exactamente igual.

se pueden poner puntos, tipo `user.mail`

a lo sumo pasa eso en los logs del bot

```json
2021-11-02 18:05:19 ERROR    rasa.shared.core.trackers  - Tried to set non existent slot 'notset'. Make sure you added all your slots to your domain file.
```

siempre los bots tienen que tener una intent start sin nlu donde este el mensaje de inicio del bot. 

November 2, 2021 9:31 PM anda joya

ahora quiero que ante transfer y offline se bajen todos los slots a parametros

November 2, 2021 10:10 PM armo una branch en la que se pide un valor

```json
/Users/alex/Documents/rasa/2.8.5/.venv/lib/python3.8/site-packages/rasa/shared/utils/io.py:97: UserWarning: Interpreter parsed an entity 'number' which is not defined in the domain. Please make sure all entities are listed in the domain.
  More info at https://rasa.com/docs/rasa/domain
```

```json
7 forms:
108   restaurant_form:
109     ignored_intents:
110     - chitchat
111     required_slots:
112       cuisine:
113       - entity: cuisine
114         type: from_entity
115       feedback:
116       - entity: feedback
117         type: from_entity
118       - type: from_text
119       num_people:
120       - entity: number
121         intent:
122         - inform
123         - request_restaurant
124         type: from_entity
125       outdoor_seating:
126       - entity: seating
127         type: from_entity
128       - intent: affirm
129         type: from_intent
130         value: true
131       - intent: deny
132         type: from_intent
133         value: false
134       preferences:
135       - intent: deny
136         type: from_intent
137         value: no additional preferences
138       - not_intent: affirm
139         type: from_text
```

November 3, 2021 12:42 AM listo ahora con *offline y *transfer todos los slots vuelven en los Parameters con el mismo formato de concordia. es hermoso.

November 3, 2021 12:59 AM pusheada `alexanderditzend/gateway:2.1.0`

November 3, 2021 1:24 AM probada en mib

Todos los bots tienen que arrancar con *start*

Para transferir, un *utter_transfer* podria ser *gwi_show_message_then_transfer>>>Perfecto {user.name}, te estoy pasando con un agente!* y eso muestra el mensaje y despues transfiere

---

Esta version tiene tambien un close, idem ejemplo de arriba pero *gwi_show_message_then_close>>>blah*

el bot mitrol_base tiene todo esto

November 3, 2021 1:50 AM probado ok aca

[Chat](https://inno-pub-con-ar.mitrol.net/concordia/chat/chat.html?serviceRoute=Alojamiento_worker)

transfer anda bien, pero offline no cierra la sesion

```bash
2021-11-03T05:00:26.299473133Z info: Botfarm Gateway started {"module":"main","version":"2.1.0"},
2021-11-03T05:00:26.722985564Z info: WebSocket started {"depends_on":"CONCORDIA ^1.15.0","module":"webSocket","web_socket_port":"8646"},
2021-11-03T05:00:26.868181122Z info: Api Rest started  {"module":"apiRest","url":"/bot"},
2021-11-03T13:47:53.361892486Z debug: A new message hit the socket  {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*online","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"186.22.18.95","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita"},
2021-11-03T13:47:53.364013723Z debug: *online received {"bot_name":"Alojamiento_Worker","connection_id":"211103104753315_CHT_56000","event_name":"*online","origin":"USER","user_name":"Lilita"},
2021-11-03T13:47:53.379519106Z debug: 🔀 Requested BotName: Alojamiento_Worker Dispatched to:http://alojamiento_worker_bm:5005 {"body":{"message":"/start","sender":"211103104753315_CHT_56000"},"json":true,"method":"POST","uri":"http://alojamiento_worker_bm:5005/webhooks/rest/webhook"},
2021-11-03T13:47:53.468051747Z debug: Param user.channel=21 inserted {"active_loop":{},"body":{"event":"slot","name":"user.channel","timestamp":1635947273377,"value":"21"},"events":null,"followup_action":null,"json":true,"latest_action":{"action_name":"action_listen"},"latest_action_name":"action_listen","latest_event_time":1635947273377,"latest_input_channel":null,"latest_message":{"entities":[],"intent":{},"message_id":null,"metadata":{},"text":null},"method":"POST","paused":false,"sender_id":"211103104753315_CHT_56000","slots":{"session_started_metadata":null,"user.age":0,"user.channel":"21","user.mail":"Lilita@myserver.com","user.name":"Lilita"},"uri":"http://alojamiento_worker_bm:5005/conversations/211103104753315_CHT_56000/tracker/events?include_events=NONE"},
2021-11-03T13:47:53.472313791Z debug: Param user.mail=Lilita@myserver.com inserted {"active_loop":{},"body":{"event":"slot","name":"user.mail","timestamp":1635947273376,"value":"Lilita@myserver.com"},"events":null,"followup_action":null,"json":true,"latest_action":{"action_name":"action_listen"},"latest_action_name":"action_listen","latest_event_time":1635947273376,"latest_input_channel":null,"latest_message":{"entities":[],"intent":{},"message_id":null,"metadata":{},"text":null},"method":"POST","paused":false,"sender_id":"211103104753315_CHT_56000","slots":{"session_started_metadata":null,"user.age":0,"user.channel":null,"user.mail":"Lilita@myserver.com","user.name":"Lilita"},"uri":"http://alojamiento_worker_bm:5005/conversations/211103104753315_CHT_56000/tracker/events?include_events=NONE"},
2021-11-03T13:47:53.473014903Z debug: Param user.name=Lilita inserted {"active_loop":{},"body":{"event":"slot","name":"user.name","timestamp":1635947273364,"value":"Lilita"},"events":null,"followup_action":null,"json":true,"latest_action":{"action_name":"action_listen"},"latest_action_name":"action_listen","latest_event_time":1635947273364,"latest_input_channel":null,"latest_message":{"entities":[],"intent":{},"message_id":null,"metadata":{},"text":null},"method":"POST","paused":false,"sender_id":"211103104753315_CHT_56000","slots":{"session_started_metadata":null,"user.age":0,"user.channel":null,"user.mail":null,"user.name":"Lilita"},"uri":"http://alojamiento_worker_bm:5005/conversations/211103104753315_CHT_56000/tracker/events?include_events=NONE"},
2021-11-03T13:47:53.474139178Z debug: ➡️ Inbound : Bot Says Hola Lilita, tengo tu mail registrado Lilita@myserver.com y estas en el canal 21 {"recipient_id":"211103104753315_CHT_56000","text":"Hola Lilita, tengo tu mail registrado Lilita@myserver.com y estas en el canal 21"},
2021-11-03T13:47:53.475061718Z debug: ⬅️ Outbound Message sent via Socket {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*text","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"Hola Lilita, tengo tu mail registrado Lilita@myserver.com y estas en el canal 21","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"186.22.18.95","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita","module":"sendSocketMessageToBot sendMessageToSocket"},
2021-11-03T13:48:01.974189743Z debug: A new message hit the socket  {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*text","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"cmd=&msg=hola&","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"186.22.18.95","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita"},
2021-11-03T13:48:01.974203792Z debug: 🔀 Requested BotName: Alojamiento_Worker Dispatched to:http://alojamiento_worker_bm:5005 {"body":{"message":"hola","sender":"211103104753315_CHT_56000"},"json":true,"method":"POST","uri":"http://alojamiento_worker_bm:5005/webhooks/rest/webhook"},
2021-11-03T13:48:02.040172026Z debug: ➡️ Inbound : Bot Says Hola! Cuántos años tienes? {"recipient_id":"211103104753315_CHT_56000","text":"Hola! Cuántos años tienes?"},
2021-11-03T13:48:02.040202221Z debug: ⬅️ Outbound Message sent via Socket {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*text","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"Hola! Cuántos años tienes?","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"186.22.18.95","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita","module":"sendSocketMessageToBot sendMessageToSocket"},
2021-11-03T13:48:12.151842870Z debug: A new message hit the socket  {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*text","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"cmd=&msg=100&","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"186.22.18.95","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita"},
2021-11-03T13:48:12.151897782Z debug: 🔀 Requested BotName: Alojamiento_Worker Dispatched to:http://alojamiento_worker_bm:5005 {"body":{"message":"100","sender":"211103104753315_CHT_56000"},"json":true,"method":"POST","uri":"http://alojamiento_worker_bm:5005/webhooks/rest/webhook"},
2021-11-03T13:48:12.204247501Z debug: ➡️ Inbound : Bot Says 100 años, entiendo {"recipient_id":"211103104753315_CHT_56000","text":"100 años, entiendo"},
2021-11-03T13:48:12.204743957Z debug: ⬅️ Outbound Message sent via Socket {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*text","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"100 años, entiendo","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"186.22.18.95","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita","module":"sendSocketMessageToBot sendMessageToSocket"},
2021-11-03T13:48:19.545775038Z debug: A new message hit the socket  {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*text","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"cmd=&msg=chau&","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"186.22.18.95","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita"},
2021-11-03T13:48:19.546407636Z debug: 🔀 Requested BotName: Alojamiento_Worker Dispatched to:http://alojamiento_worker_bm:5005 {"body":{"message":"chau","sender":"211103104753315_CHT_56000"},"json":true,"method":"POST","uri":"http://alojamiento_worker_bm:5005/webhooks/rest/webhook"},
2021-11-03T13:48:19.605530359Z debug: ➡️ Inbound : Bot Says gwi_show_message_then_close>>>Cerrando sesión, hasta la próxima! {"recipient_id":"211103104753315_CHT_56000","text":"gwi_show_message_then_close>>>Cerrando sesión, hasta la próxima!"},
2021-11-03T13:48:19.606189501Z debug: Showing last message before closing ,
2021-11-03T13:48:19.616657376Z debug: tracker data,
2021-11-03T13:48:19.617112949Z debug: user.name=Lilita,
2021-11-03T13:48:19.617443707Z debug: user.mail=Lilita@myserver.com,
2021-11-03T13:48:19.617760266Z debug: user.channel=21,
2021-11-03T13:48:19.618088043Z debug: user.age=100,
2021-11-03T13:48:19.618450659Z debug: session_started_metadata=null,
2021-11-03T13:48:19.619340250Z debug: SESSION CLOSED,
2021-11-03T13:49:19.603206631Z debug: A new message hit the socket  {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*online","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita"},
2021-11-03T13:49:19.603675659Z debug: *online received {"bot_name":"Alojamiento_Worker","connection_id":"211103104753315_CHT_56000","event_name":"*online","origin":"USER","user_name":"Lilita"},
2021-11-03T13:49:19.605071611Z debug: 🔀 Requested BotName: Alojamiento_Worker Dispatched to:http://alojamiento_worker_bm:5005 {"body":{"message":"/start","sender":"211103104753315_CHT_56000"},"json":true,"method":"POST","uri":"http://alojamiento_worker_bm:5005/webhooks/rest/webhook"},
2021-11-03T13:49:19.621231184Z debug: Param user.name=Lilita inserted {"active_loop":{},"body":{"event":"slot","name":"user.name","timestamp":1635947359603,"value":"Lilita"},"events":null,"followup_action":null,"json":true,"latest_action":{"action_name":"action_listen"},"latest_action_name":"action_listen","latest_event_time":1635947359603,"latest_input_channel":"rest","latest_message":{"entities":[],"intent":{"confidence":0.9999945163726807,"id":3163099076469830000,"name":"goodbye"},"intent_ranking":[{"confidence":0.9999945163726807,"id":3163099076469830000,"name":"goodbye"},{"confidence":0.000004680404344981071,"id":-7654481096349226000,"name":"age"},{"confidence":4.3619991174637107e-7,"id":4436246450393130500,"name":"greet"},{"confidence":4.072734327564831e-7,"id":-1644415099564076500,"name":"agent"}],"message_id":"18a144ce7d614130a4162ca4466b917b","metadata":{},"text":"chau"},"method":"POST","paused":false,"sender_id":"211103104753315_CHT_56000","slots":{"session_started_metadata":null,"user.age":"100","user.channel":"21","user.mail":"Lilita@myserver.com","user.name":"Lilita"},"uri":"http://alojamiento_worker_bm:5005/conversations/211103104753315_CHT_56000/tracker/events?include_events=NONE"},
2021-11-03T13:49:19.690866608Z debug: ➡️ Inbound : Bot Says Hola Lilita, tengo tu mail registrado Lilita@myserver.com y estas en el canal 21 {"recipient_id":"211103104753315_CHT_56000","text":"Hola Lilita, tengo tu mail registrado Lilita@myserver.com y estas en el canal 21"},
2021-11-03T13:49:19.691415391Z debug: ⬅️ Outbound Message sent via Socket {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*text","InteractionId":"211103104753315_CHT_56000","Lang":"es","Message":"Hola Lilita, tengo tu mail registrado Lilita@myserver.com y estas en el canal 21","MimeType":"text/plain","Parameters":["user.name=Lilita","user.mail=Lilita@myserver.com","user.channel=21"],"Source":"","UserChannel":"21","UserId":"Lilita","UserMail":"Lilita@myserver.com","UserName":"Lilita","module":"sendSocketMessageToBot sendMessageToSocket"},
2021-11-03T13:49:19.693124194Z debug: Param user.mail=Lilita@myserver.com inserted {"active_loop":{},"body":{"event":"slot","name":"user.mail","timestamp":1635947359604,"value":"Lilita@myserver.com"},"events":null,"followup_action":null,"json":true,"latest_action":{"action_name":"action_listen"},"latest_action_name":"action_listen","latest_event_time":1635947359604,"latest_input_channel":"rest","latest_message":{"entities":[],"intent":{"confidence":0.9999945163726807,"id":3163099076469830000,"name":"goodbye"},"intent_ranking":[{"confidence":0.9999945163726807,"id":3163099076469830000,"name":"goodbye"},{"confidence":0.000004680404344981071,"id":-7654481096349226000,"name":"age"},{"confidence":4.3619991174637107e-7,"id":4436246450393130500,"name":"greet"},{"confidence":4.072734327564831e-7,"id":-1644415099564076500,"name":"agent"}],"message_id":"18a144ce7d614130a4162ca4466b917b","metadata":{},"text":"chau"},"method":"POST","paused":false,"sender_id":"211103104753315_CHT_56000","slots":{"session_started_metadata":null,"user.age":"100","user.channel":"21","user.mail":"Lilita@myserver.com","user.name":"Lilita"},"uri":"http://alojamiento_worker_bm:5005/conversations/211103104753315_CHT_56000/tracker/events?include_events=NONE"},
2021-11-03T13:49:19.693846684Z debug: Param user.channel=21 inserted {"active_loop":{},"body":{"event":"slot","name":"user.channel","timestamp":1635947359604,"value":"21"},"events":null,"followup_action":null,"json":true,"latest_action":{"action_name":"action_listen"},"latest_action_name":"action_listen","latest_event_time":1635947359604,"latest_input_channel":"rest","latest_message":{"entities":[],"intent":{"confidence":0.9999945163726807,"id":3163099076469830000,"name":"goodbye"},"intent_ranking":[{"confidence":0.9999945163726807,"id":3163099076469830000,"name":"goodbye"},{"confidence":0.000004680404344981071,"id":-7654481096349226000,"name":"age"},{"confidence":4.3619991174637107e-7,"id":4436246450393130500,"name":"greet"},{"confidence":4.072734327564831e-7,"id":-1644415099564076500,"name":"agent"}],"message_id":"18a144ce7d614130a4162ca4466b917b","metadata":{},"text":"chau"},"method":"POST","paused":false,"sender_id":"211103104753315_CHT_56000","slots":{"session_started_metadata":null,"user.age":"100","user.channel":"21","user.mail":"Lilita@myserver.com","user.name":"Lilita"},"uri":"http://alojamiento_worker_bm:5005/conversations/211103104753315_CHT_56000/tracker/events?include_events=NONE"},
2021-11-03T13:49:23.748630169Z debug: A new message hit the socket  {"BotName":"Alojamiento_Worker","Channel":"web_sock","Encoding":"utf-8","EventName":"*offline","InteractionId":"","Lang":"es","Message":"chau","MimeType":"text/plain","Parameters":["user.name=","user.mail=@myserver.com","user.channel=21"],"Source":"","UserChannel":"21","UserId":"","UserMail":"@myserver.com","UserName":""},
2021-11-03T13:49:23.749115513Z error: NO InteractionId PARAM RECEIVED, CHECK CONCORDIA {"module":"webSocket processMessage"}
```